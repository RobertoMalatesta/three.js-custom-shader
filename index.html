<!doctype html>
<html>
	<head>
		<title>three.js custom shader</title>
	</head>
	<body>
		<script type="x-shader/x-vertex" id="vertexshader">
			#ifdef GL_ES
			precision highp float;
			#endif

			varying vec3 vNormal;

			void main() {
				vNormal = normal + vec3(1, 0, 0);
				gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
			}
		</script>

		<script type="x-shader/x-fragment" id="fragmentshader">
			#ifdef GL_ES
			precision highp float;
			#endif

			varying vec3 vNormal;

			void main() {
				vec3 light = vec3(0.0, 0.2, 1.0);
				light = normalize(light);
				float intensity = max(0.0, dot(vNormal, light));
				gl_FragColor = vec4(intensity, intensity, intensity, 1.0);
			}
		</script>
	<script src="js/three.js"></script>

	<script>
		var width = 400;
		var height = 300;

		var renderer = new THREE.WebGLRenderer();
		var camera = new THREE.Camera(45, width / height, 0.1, 10000);
		var scene = new THREE.Scene();
		camera.position.z = 300;

		renderer.setSize(width, height);
		var canvas = renderer.domElement;
		canvas.style.border = "1px solid black";
		document.body.appendChild(canvas);

		var shaderMaterial = new THREE.MeshShaderMaterial({
			vertexShader: document.getElementById("vertexshader").text,
			fragmentShader: document.getElementById("fragmentshader").text
		});

		var radius = 50, segments = 8, rings = 5;
		var sphere = new THREE.Mesh(
			new THREE.Sphere(radius, segments, rings),
			shaderMaterial
		);

		scene.addChild(sphere);
		renderer.render(scene, camera);
	</script>
	</body>
</html>
